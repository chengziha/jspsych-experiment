var jsPsychImageSliderResponse=function(e){"use strict";function t(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,(a=s.key,r=void 0,"symbol"==typeof(r=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"))?r:String(r)),s)}var a,r}var i={name:"image-slider-response",parameters:{stimulus:{type:e.ParameterType.IMAGE,pretty_name:"Stimulus",default:void 0},stimulus_height:{type:e.ParameterType.INT,pretty_name:"Image height",default:null},stimulus_width:{type:e.ParameterType.INT,pretty_name:"Image width",default:null},maintain_aspect_ratio:{type:e.ParameterType.BOOL,pretty_name:"Maintain aspect ratio",default:!0},min:{type:e.ParameterType.INT,pretty_name:"Min slider",default:0},max:{type:e.ParameterType.INT,pretty_name:"Max slider",default:100},slider_start:{type:e.ParameterType.INT,pretty_name:"Slider starting value",default:50},step:{type:e.ParameterType.INT,pretty_name:"Step",default:1},labels:{type:e.ParameterType.HTML_STRING,pretty_name:"Labels",default:[],array:!0},slider_width:{type:e.ParameterType.INT,pretty_name:"Slider width",default:null},button_label:{type:e.ParameterType.STRING,pretty_name:"Button label",default:"Continue",array:!1},require_movement:{type:e.ParameterType.BOOL,pretty_name:"Require movement",default:!1},prompt:{type:e.ParameterType.HTML_STRING,pretty_name:"Prompt",default:null},stimulus_duration:{type:e.ParameterType.INT,pretty_name:"Stimulus duration",default:null},trial_duration:{type:e.ParameterType.INT,pretty_name:"Trial duration",default:null},response_ends_trial:{type:e.ParameterType.BOOL,pretty_name:"Response ends trial",default:!0},render_on_canvas:{type:e.ParameterType.BOOL,pretty_name:"Render on canvas",default:!0}}},s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.jsPsych=t}var i,s,a;return i=e,(s=[{key:"trial",value:function(e,t){var i,s,a,r=this;if(t.render_on_canvas){var n=!1;if(e.hasChildNodes())for(;e.firstChild;)e.removeChild(e.firstChild);var l=document.createElement("div");l.id="jspsych-image-slider-response-wrapper",l.style.margin="100px 0px";var u=document.createElement("canvas");u.id="jspsych-image-slider-response-stimulus",u.style.margin="0",u.style.padding="0";var o=u.getContext("2d");(_=new Image).onload=function(){n||(p(),o.drawImage(_,0,0,s,i))},_.src=t.stimulus;var p=function(){null!==t.stimulus_height?(i=t.stimulus_height,null==t.stimulus_width&&t.maintain_aspect_ratio&&(s=_.naturalWidth*(t.stimulus_height/_.naturalHeight))):i=_.naturalHeight,null!==t.stimulus_width?(s=t.stimulus_width,null==t.stimulus_height&&t.maintain_aspect_ratio&&(i=_.naturalHeight*(t.stimulus_width/_.naturalWidth))):null!==t.stimulus_height&&t.maintain_aspect_ratio||(s=_.naturalWidth),u.height=i,u.width=s};p();var m=document.createElement("div");m.classList.add("jspsych-image-slider-response-container"),m.style.position="relative",m.style.margin="0 auto 3em auto",null!==t.slider_width&&(m.style.width=t.slider_width.toString()+"px"),a='<input type="range" class="jspsych-slider" value="'+t.slider_start+'" min="'+t.min+'" max="'+t.max+'" step="'+t.step+'" id="jspsych-image-slider-response-response"></input>',a+="<div>";for(var d=0;d<t.labels.length;d++){var h=100/(t.labels.length-1);a+='<div style="border: 1px solid transparent; display: inline-block; position: absolute; left:calc('+(c=d*(100/(t.labels.length-1)))+"% - ("+h+"% / 2) - "+(c-50)/50*100*7.5/100+"px); text-align: center; width: "+h+'%;">',a+='<span style="text-align: center; font-size: 80%;">'+t.labels[d]+"</span>",a+="</div>"}a+="</div>",m.innerHTML=a,l.insertBefore(u,l.firstElementChild),l.insertBefore(m,u.nextElementSibling),e.insertBefore(l,null),_.complete&&Number.isFinite(s)&&Number.isFinite(i)&&(o.drawImage(_,0,0,s,i),n=!0),null!==t.prompt&&e.insertAdjacentHTML("beforeend",t.prompt);var y=document.createElement("button");y.id="jspsych-image-slider-response-next",y.classList.add("jspsych-btn"),y.disabled=!!t.require_movement,y.innerHTML=t.button_label,e.insertBefore(y,e.nextElementSibling)}else{for(a='<div id="jspsych-image-slider-response-wrapper" style="margin: 100px 0px;">',a+='<div id="jspsych-image-slider-response-stimulus">',a+='<img src="'+t.stimulus+'" style="',null!==t.stimulus_height&&(a+="height:"+t.stimulus_height+"px; ",null==t.stimulus_width&&t.maintain_aspect_ratio&&(a+="width: auto; ")),null!==t.stimulus_width&&(a+="width:"+t.stimulus_width+"px; ",null==t.stimulus_height&&t.maintain_aspect_ratio&&(a+="height: auto; ")),a+='"></img>',a+="</div>",a+='<div class="jspsych-image-slider-response-container" style="position:relative; margin: 0 auto 3em auto; width:',null!==t.slider_width?a+=t.slider_width+"px;":a+="auto;",a+='">',a+='<input type="range" class="jspsych-slider" value="'+t.slider_start+'" min="'+t.min+'" max="'+t.max+'" step="'+t.step+'" id="jspsych-image-slider-response-response"></input>',a+="<div>",d=0;d<t.labels.length;d++){var c;h=100/(t.labels.length-1),a+='<div style="border: 1px solid transparent; display: inline-block; position: absolute; left:calc('+(c=d*(100/(t.labels.length-1)))+"% - ("+h+"% / 2) - "+(c-50)/50*100*7.5/100+"px); text-align: center; width: "+h+'%;">',a+='<span style="text-align: center; font-size: 80%;">'+t.labels[d]+"</span>",a+="</div>"}a+="</div>",a+="</div>",a+="</div>",null!==t.prompt&&(a+=t.prompt),a+='<button id="jspsych-image-slider-response-next" class="jspsych-btn" '+(t.require_movement?"disabled":"")+">"+t.button_label+"</button>",e.innerHTML=a;var _=e.querySelector("img");null!==t.stimulus_height?(i=t.stimulus_height,null==t.stimulus_width&&t.maintain_aspect_ratio&&(s=_.naturalWidth*(t.stimulus_height/_.naturalHeight))):i=_.naturalHeight,null!==t.stimulus_width?(s=t.stimulus_width,null==t.stimulus_height&&t.maintain_aspect_ratio&&(i=_.naturalHeight*(t.stimulus_width/_.naturalWidth))):null!==t.stimulus_height&&t.maintain_aspect_ratio||(s=_.naturalWidth),_.style.height=i.toString()+"px",_.style.width=s.toString()+"px"}var g={rt:null,response:null};if(t.require_movement){var v=function(){e.querySelector("#jspsych-image-slider-response-next").disabled=!1};e.querySelector("#jspsych-image-slider-response-response").addEventListener("mousedown",v),e.querySelector("#jspsych-image-slider-response-response").addEventListener("touchstart",v),e.querySelector("#jspsych-image-slider-response-response").addEventListener("change",v)}var f=function(){r.jsPsych.pluginAPI.clearAllTimeouts();var i={rt:g.rt,stimulus:t.stimulus,slider_start:t.slider_start,response:g.response};e.innerHTML="",r.jsPsych.finishTrial(i)};e.querySelector("#jspsych-image-slider-response-next").addEventListener("click",(function(){var i=performance.now();g.rt=Math.round(i-b),g.response=e.querySelector("#jspsych-image-slider-response-response").valueAsNumber,t.response_ends_trial?f():e.querySelector("#jspsych-image-slider-response-next").disabled=!0})),null!==t.stimulus_duration&&this.jsPsych.pluginAPI.setTimeout((function(){e.querySelector("#jspsych-image-slider-response-stimulus").style.visibility="hidden"}),t.stimulus_duration),null!==t.trial_duration&&this.jsPsych.pluginAPI.setTimeout((function(){f()}),t.trial_duration);var b=performance.now()}},{key:"simulate",value:function(e,t,i,s){"data-only"==t&&(s(),this.simulate_data_only(e,i)),"visual"==t&&this.simulate_visual(e,i,s)}},{key:"create_simulation_data",value:function(e,t){var i={stimulus:e.stimulus,slider_start:e.slider_start,response:this.jsPsych.randomization.randomInt(e.min,e.max),rt:this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0)},s=this.jsPsych.pluginAPI.mergeSimulationData(i,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,s),s}},{key:"simulate_data_only",value:function(e,t){var i=this.create_simulation_data(e,t);this.jsPsych.finishTrial(i)}},{key:"simulate_visual",value:function(e,t,i){var s=this,a=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();if(this.trial(r,e),i(),null!==a.rt){var n=r.querySelector("input[type='range']");setTimeout((function(){s.jsPsych.pluginAPI.clickTarget(n),n.valueAsNumber=a.response}),a.rt/2),this.jsPsych.pluginAPI.clickTarget(r.querySelector("button"),a.rt)}}}])&&t(i.prototype,s),a&&t(i,a),Object.defineProperty(i,"prototype",{writable:!1}),e}();return s.info=i,s}(jsPsychModule);
//# sourceMappingURL=https://unpkg.com/@jspsych/plugin-image-slider-response@1.1.3/dist/index.browser.min.js.map